---
title: "Knowledge Kernel"
description: "The cognitive core that governs knowledge lifecycle"
icon: "brain"
---

# Knowledge Kernel

At the heart of CogMem is the **Knowledge Kernel**—a persistent, deterministic system responsible for how memory is formed, structured, and maintained. The kernel is not an agent that generates text; it governs the knowledge lifecycle.

The kernel operates according to the active **MemoryStrategy** resolved by the Adaptive Cognitive Plane. While the kernel itself is deterministic, the strategy that governs its behavior can evolve over time based on observed outcomes.

## What the Kernel Does

The Knowledge Kernel sits beneath agents and tools, governing how information becomes knowledge and how that knowledge evolves:

<CardGroup cols={2}>
  <Card title="Admission Control" icon="filter">
    Deciding what information is worth remembering
  </Card>
  <Card title="Transformation" icon="arrows-rotate">
    Promoting raw data into structured representations (Claims)
  </Card>
  <Card title="Conflict Tracking" icon="code-branch">
    Identifying and retaining competing claims
  </Card>
  <Card title="Maintenance" icon="wrench">
    Merging, decaying, refreshing, and reinforcing memories
  </Card>
</CardGroup>

```python
from kos.kernel import KnowledgeKernel
from kos.core.acp.strategy_resolver import StrategyResolver

resolver = StrategyResolver(strategy_store=strategy_store)
strategy = await resolver.resolve(tenant_id="my-tenant")

kernel = KnowledgeKernel(
    object_store=object_store,
    outbox_store=outbox_store,
    claim_store=claim_store,
    strategy=strategy,  # Strategy-aware kernel
)

# Process incoming information through the kernel
await kernel.ingest(item)
await kernel.extract_claims(passage_ids)
await kernel.detect_conflicts(entity_id)
```

## Kernel Event Model

The kernel logs all decisions as events for debugging, visualization, and evaluation:

<CardGroup cols={2}>
  <Card title="Event-Driven" icon="bolt">
    All kernel decisions emit events to the outbox
  </Card>
  <Card title="Idempotent" icon="repeat">
    Operations can be safely retried on failure
  </Card>
  <Card title="Provenance" icon="clock-rotate-left">
    Every decision is logged for traceability
  </Card>
  <Card title="Inspectable" icon="magnifying-glass">
    Event stream can be queried and visualized
  </Card>
</CardGroup>

## Kernel Event Types

```python
class KernelEventType(str, Enum):
    # Ingestion events
    ITEM_INGESTED = "item_ingested"
    PASSAGE_EXTRACTED = "passage_extracted"
    
    # Knowledge formation events
    ENTITY_LINKED = "entity_linked"
    CLAIM_PROPOSED = "claim_proposed"
    CLAIM_ACCEPTED = "claim_accepted"
    CLAIM_CONFLICT_DETECTED = "claim_conflict_detected"
    
    # Artifact events
    ARTIFACT_GENERATED = "artifact_generated"
```

## Agent Subsystem

Agents interact through the kernel but do not own memory themselves. The kernel coordinates specialized agents:

### ChunkAgent

Splits items into passages. Chunking parameters are governed by the active MemoryStrategy's `document_policy`.

| Property | Value |
|----------|-------|
| **Consumes** | `ITEM_UPSERTED` |
| **Emits** | `PASSAGES_CREATED` |
| **Writes to** | ObjectStore (passages) |
| **Strategy-aware** | `document_policy.chunking_mode`, `chunk_size`, `overlap` |

```python
from kos.agents.ingest.chunk_agent import ChunkAgent

# ChunkAgent reads document_policy from the resolved strategy
agent = ChunkAgent(
    object_store=object_store,
    outbox_store=outbox_store,
    strategy_resolver=strategy_resolver,
)
```

### EmbedAgent

Generates embeddings for passages.

| Property | Value |
|----------|-------|
| **Consumes** | `PASSAGES_CREATED` |
| **Emits** | `VECTORS_CREATED` |
| **Writes to** | VectorSearchProvider |

```python
from kos.agents.enrich.embed_agent import EmbedAgent

agent = EmbedAgent(
    object_store=object_store,
    outbox_store=outbox_store,
    vector_search=vector_search,
    embedder=embedder,
    batch_size=32,
)
```

### IndexTextAgent

Indexes passages in text search.

| Property | Value |
|----------|-------|
| **Consumes** | `PASSAGES_CREATED` |
| **Emits** | `TEXT_INDEXED` |
| **Writes to** | TextSearchProvider |

```python
from kos.agents.index.index_text_agent import IndexTextAgent

agent = IndexTextAgent(
    object_store=object_store,
    outbox_store=outbox_store,
    text_search=text_search,
)
```

### EntityExtractAgent

Extracts named entities from passages.

| Property | Value |
|----------|-------|
| **Consumes** | `PASSAGES_CREATED` |
| **Emits** | `ENTITIES_EXTRACTED` |
| **Writes to** | ObjectStore (entities), GraphSearchProvider |

```python
from kos.agents.extract.entity_extract_agent import EntityExtractAgent

agent = EntityExtractAgent(
    object_store=object_store,
    outbox_store=outbox_store,
    graph_search=graph_search,
    llm_gateway=llm_gateway,  # Optional
    use_llm=True,
)
```

### ClaimExtractAgent

Extracts structured claims from passages.

| Property | Value |
|----------|-------|
| **Consumes** | `PASSAGES_CREATED` |
| **Emits** | `CLAIM_PROPOSED` |
| **Writes to** | ObjectStore (claims) |

```python
from kos.agents.extract.claim_extract_agent import ClaimExtractAgent

agent = ClaimExtractAgent(
    object_store=object_store,
    outbox_store=outbox_store,
    llm_gateway=llm_gateway,
)
```

## Knowledge Formation Pipeline

The Knowledge Kernel orchestrates the transformation of raw data into structured knowledge:

```
                    ITEM_INGESTED
                          │
                          ▼
               ┌─────────────────────┐
               │   Knowledge Kernel  │
               │  (admission control)│
               └─────────────────────┘
                          │
                          ▼
                  PASSAGE_EXTRACTED
                          │
     ┌────────────────────┼────────────────────┐
     ▼                    ▼                    ▼
┌──────────┐       ┌──────────────┐     ┌──────────────┐
│  Embed   │       │EntityExtract │     │ ClaimExtract │
└──────────┘       └──────────────┘     └──────────────┘
     │                    │                    │
     ▼                    ▼                    ▼
VECTORS_CREATED    ENTITY_LINKED        CLAIM_PROPOSED
                                               │
                                               ▼
                                    ┌─────────────────────┐
                                    │   Conflict Detection│
                                    └─────────────────────┘
                                               │
                              ┌────────────────┴────────────────┐
                              ▼                                 ▼
                      CLAIM_ACCEPTED              CLAIM_CONFLICT_DETECTED
```

## Running Workers

```bash
# Start worker to process all events
kos run-worker

# With options
kos run-worker --poll-interval 1.0 --batch-size 10
```

## Creating Custom Agents

```python
from kos.agents.base import BaseAgent
from kos.core.events.event_types import EventType
from kos.core.events.envelope import EventEnvelope

class MyCustomAgent(BaseAgent):
    agent_id = "my_custom_agent"
    consumes_events = [EventType.PASSAGES_CREATED]
    
    async def process_event(self, event: EventEnvelope) -> list[EventEnvelope]:
        # Process the event
        passage_ids = event.payload.get("passage_ids", [])
        
        # Do work...
        
        # Log action for provenance
        await self.log_action(
            tenant_id=event.tenant_id,
            user_id=event.payload.get("user_id"),
            action_type="my_action",
            inputs=passage_ids,
            outputs=["output-1"],
        )
        
        # Optionally emit new events
        return []
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Adaptive Cognitive Plane" icon="arrows-rotate" href="/architecture/adaptive-cognitive-plane">
    How the system evolves its own strategies
  </Card>
  <Card title="Knowledge Workflows" icon="route" href="/architecture/knowledge-workflows">
    See how knowledge becomes artifacts
  </Card>
  <Card title="API Reference" icon="square-terminal" href="/api-reference/overview">
    Explore the API
  </Card>
</CardGroup>
